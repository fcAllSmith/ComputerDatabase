package com.excilys.computerdb.fconsigny.business.mapper;

import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.List;
import java.util.StringTokenizer;

import com.excilys.computerdb.fconsigny.business.model.Computer;
import com.excilys.computerdb.fconsigny.presentation.dto.ComputerDto;

public class ComputerDtoMapper {

	public static ComputerDto transformToDto(Computer computer){
		if(computer != null){
			ComputerDto computerDto = new ComputerDto();
			computerDto.setCompanyId(computer.getId());
			computerDto.setName(computer.getName());

			if (computer.getIntroduced()!= null) {
				computerDto.setInserted(computer.getIntroduced().toString());
			}

			if (computer.getIntroduced()!= null) {
				computerDto.setDiscontinued(computer.getDiscontinued().toString());
			}

			computerDto.setCompanyId(computer.getCompanyId());
			return computerDto;
		}

		return null;
	}

	public static List<ComputerDto> transformListToDto(List<Computer> computerList){
		List<ComputerDto> computerDtoList = new ArrayList<ComputerDto>();;

		for(Computer computer : computerList){
			computerDtoList.add(transformToDto(computer));
		}

		return computerDtoList;
	}

	public static Computer transformToComputer(ComputerDto computerDto){
		
		// LocalTime time = LocalTime.parse("00:00",formatter);
        //LocalDate date = LocalDate.of(2000, 1, 1);
        //LocalDateTime dateTime = date.atTime(time);
		
		Computer computer  = new Computer(computerDto.getId());
		computer.setName(computerDto.getName());

		if(!computerDto.getInserted().matches("-") && computerDto.getInserted() != null){
			DateTimeFormatter dtf = DateTimeFormatter.ofPattern("yyyy-MM-dd");
			StringTokenizer st = new StringTokenizer(computer.getIntroduced(),"-");
			LocalDate date = LocalDate.of(st.nextToken(),st.nextToken(),st.nextToken());
			computer.setIntroduced(LocalDateTime.parse(computerDto.getInserted(), dtf));
		}

		if(!computerDto.getDiscontinued().matches("-") && computerDto.getDiscontinued() != null){
			DateTimeFormatter dtf = DateTimeFormatter.ofPattern("yyyy-MM-dd");
			computer.setDiscontinued(LocalDateTime.parse(computerDto.getDiscontinued(),dtf));
		}

		computer.setCompanyId(computerDto.getCompanyId());
		return computer;

	}
}
